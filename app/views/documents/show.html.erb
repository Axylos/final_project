<h1><%= @document.title %></h1>

<h2>Document:</h2>
<%= @document.body %>
<br>
<h3>Author: <br><%= @document.author.email %></h3>

<h2>Annotations</h2>
<% unless @document.annotations.empty? %>
  <ul>
    <% @document.annotations.each do |annotation| %>
      <li>
        <%= link_to annotation.title, document_url(annotation) %>
          by <%= annotation.author.email %>
      </li>
    <% end %>
  </ul>
<% else %>
  <h4>No Annotations Yet</h4>
<% end %>

<%= render "annotations/form", document: @document, refs: false %>

<h2>Annotated Texts</h2>
<% unless @document.annotated_docs.empty? %>
  <ul>
    <% @document.annotated_docs.each do |annotation| %>
    <% source_doc = annotation.source_document %>
      <li>
        <%= link_to source_doc.title, document_url(source_doc) %>
        authored by <%= source_doc.author.email %>
        <p>
          <%= annotation.text_selection %>
        </p>
      </li>
    <% end %>
  </ul>

<% else %>
  <p>No Annotated Texts</p>
<% end %>

<%= link_to "Add References", new_document_reference_url(@document) %>
